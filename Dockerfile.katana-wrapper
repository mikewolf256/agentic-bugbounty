FROM projectdiscovery/katana:latest

WORKDIR /app

RUN apk add --no-cache python3 py3-pip
RUN python3 -m venv /opt/venv \
 && /opt/venv/bin/pip install --no-cache-dir fastapi uvicorn

ENV PATH="/opt/venv/bin:$PATH"

COPY tools/katana_wrapper.py /app/katana_wrapper.py

EXPOSE 8080

CMD ["uvicorn", "katana_wrapper:app", "--host", "0.0.0.0", "--port", "8080"]