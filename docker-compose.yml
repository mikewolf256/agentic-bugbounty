version: "3.9"
services:
  zap:
    image: ghcr.io/zaproxy/zaproxy
    command: [
      "zap.sh",
      "-daemon",
      "-host", "0.0.0.0",
      "-port", "8080",
      "-config", "api.disablekey=true",
      "-config", "api.addrs.addr.name=.*",
      "-config", "api.addrs.addr.regex=true"
    ]
    ports:
      - "8080:8080"

  mcp:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    environment:
      - ZAP_API_BASE=http://zap:8080
      - OUTPUT_DIR=/app/output_zap
      - NUCLEI_TEMPLATES_DIR=/app/nuclei-templates
    ports:
      - "8000:8000"
    volumes:
      - ./output_zap:/app/output_zap
      # Optionally mount your local nuclei templates into the container
      # - ~/nuclei-templates:/app/nuclei-templates:ro
    depends_on:
      - zap
